<% content_for(:breadcrumb) do %>
  <strong>Dashboard</strong>
<% end %>

<div class="admin-page-header">
  <h1 class="admin-page-title">Admin Dashboard</h1>
</div>

<div class="admin-stats-grid">
  <div class="admin-stat-card">
    <h3>Total Users</h3>
    <p class="stat-number"><%= @stats[:total_users] %></p>
    <small class="stat-detail"><%= @stats[:recent_users] %> joined this week</small>
  </div>
  
  <div class="admin-stat-card">
    <h3>Admin Users</h3>
    <p class="stat-number"><%= @stats[:admin_users] %></p>
    <small class="stat-detail">Total administrators</small>
  </div>
  
  <div class="admin-stat-card">
    <h3>Comments Today</h3>
    <p class="stat-number"><%= @stats[:comments_today] %></p>
    <small class="stat-detail">Comments and replies posted today</small>
  </div>
  
  <div class="admin-stat-card">
    <h3>Likes/Dislikes Today</h3>
    <p class="stat-number"><%= @stats[:likes_dislikes_today] %></p>
    <small class="stat-detail">Quote engagement today</small>
  </div>
</div>

<div class="admin-content-grid">
  <div class="admin-section">
    <h2>Recent Quotes</h2>
    <% if @recent_quotes.any? %>
      <% @recent_quotes.each do |quote| %>
        <div class="admin-item">
          <p style="margin: 0; font-style: italic; color: #3d2c1d;">"<%= truncate(quote.text, length: 100) %>"</p>
          <small style="color: #8b7355;">
            — <%= quote.book %><% if quote.chapter %>, Chapter <%= quote.chapter %><% end %>
            <br>Added <%= time_ago_in_words(quote.created_at) %> ago
          </small>
        </div>
      <% end %>
      <div style="text-align: center; margin-top: 1rem;">
        <%= link_to "View All Quotes", admin_quotes_path, class: "admin-link" %>
      </div>
    <% else %>
      <p style="text-align: center; color: #8b7355; margin: 2rem 0; opacity: 0.8;">No quotes found</p>
    <% end %>
  </div>
  
  <div class="admin-section">
    <h2>Recent Users</h2>
    <% if @recent_users.any? %>
      <% @recent_users.each do |user| %>
        <div class="admin-item">
          <p style="margin: 0; font-weight: 500; color: #3d2c1d;"><%= user.email %></p>
          <small style="color: #8b7355;">
            Role: <span style="background: rgba(139, 115, 85, 0.2); color: #3d2c1d; padding: 0.25rem 0.5rem; border-radius: 4px;"><%= user.role.humanize %></span>
            <br>Joined <%= time_ago_in_words(user.created_at) %> ago
          </small>
        </div>
      <% end %>
      <div style="text-align: center; margin-top: 1rem;">
        <%= link_to "View All Users", admin_users_path, class: "admin-link" %>
      </div>
    <% else %>
      <p style="text-align: center; color: #8b7355; margin: 2rem 0; opacity: 0.8;">No users found</p>
    <% end %>
  </div>
</div>

<div class="admin-section">
  <h2>Recent Activity</h2>
  <% if @recent_activities.any? %>
    <% @recent_activities.each do |activity| %>
      <div class="admin-item">
        <p style="margin: 0; color: #3d2c1d;">
          <strong><%= activity.user.email %></strong> 
          <%= activity.action_description %>
          <% if activity.target %>
            on <%= activity.target.class.name.downcase %> 
            "<%= truncate(activity.target_description, length: 50) %>"
          <% end %>
        </p>
        <small style="color: #8b7355;">
          <%= time_ago_in_words(activity.created_at) %> ago
          <% if activity.ip_address %>
            • IP: <%= activity.ip_address %>
          <% end %>
        </small>
      </div>
    <% end %>
    <div style="text-align: center; margin-top: 1rem;">
      <%= link_to "View All Activity", admin_activity_logs_path, class: "admin-link" %>
    </div>
  <% else %>
    <p style="text-align: center; color: #8b7355; margin: 2rem 0; opacity: 0.8;">No recent activity</p>
  <% end %>
</div>

<div class="admin-section" style="margin-top: 2rem; background: #f0ebe4; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #8b7355;">
  <h2 style="margin: 0 0 1rem 0; color: #3d2c1d;">Quick Actions</h2>
  <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
    <%= link_to "Add New Quote", new_admin_quote_path, 
        style: "background: #8b7355; color: #fefcfa; padding: 0.5rem 1rem; border-radius: 4px; text-decoration: none; border: 1px solid #3d2c1d;" %>
    <%= link_to "Manage Users", admin_users_path, 
        style: "background: #8b7355; color: #fefcfa; padding: 0.5rem 1rem; border-radius: 4px; text-decoration: none; border: 1px solid #3d2c1d;" %>
    <%= link_to "Export Data", admin_quotes_path(format: :csv), 
        style: "background: #8b7355; color: #fefcfa; padding: 0.5rem 1rem; border-radius: 4px; text-decoration: none; border: 1px solid #3d2c1d;" %>
  </div>
</div>
