<div class="discover-page">
  <% if @quote %>
    <!-- Show Hero Section -->
    <div class="hero-section">
      <div class="hero-content">
        <div class="discover-header">
          <h1>Quote for <%= @discover_date.strftime('%B %d, %Y') %></h1>
        </div>

        <div class="discover-notice">
          This quote was last featured on <%= @discover_date.strftime('%B %d, %Y') %>. 
          <%= link_to "View today's quote", root_path, 
                      style: "color: #8b7355; font-weight: 500;", 
                      onmouseover: "this.style.color='#6d5940'", 
                      onmouseout: "this.style.color='#8b7355'" %>.
        </div>

        <!-- Main Quote Card -->
        <div class="quote-card">
          <blockquote class="quote-text">
            <%= @quote.content %>
          </blockquote>

          <div class="metadata-section">
            <% if @quote.book.present? %>
              <div class="metadata-item">
                <span class="metadata-label">Book</span>
                <span class="metadata-value"><%= @quote.book %></span>
              </div>
            <% end %>
            <% if @quote.chapter.present? %>
              <div class="metadata-item">
                <span class="metadata-label">Chapter</span>
                <span class="metadata-value"><%= @quote.chapter %></span>
              </div>
            <% end %>
            <% if @quote.context.present? %>
              <div class="metadata-item">
                <span class="metadata-label">Context</span>
                <span class="metadata-value"><%= @quote.context %></span>
              </div>
            <% end %>
            <% if @quote.character.present? %>
              <div class="metadata-item">
                <span class="metadata-label">Character</span>
                <span class="metadata-value"><%= @quote.character %></span>
              </div>
            <% end %>
          </div>

          <!-- Engagement and Tags Section -->
          <div class="quote-engagement-section" data-quote-engagement data-quote-id="<%= @quote.id %>">
            <!-- Tags (left side) -->
            <% if @quote.tags.any? %>
              <div class="quote-tags">
                <% @quote.tags.each do |tag| %>
                  <span class="tag-badge"><%= tag.name %></span>
                <% end %>
              </div>
            <% else %>
              <div class="quote-tags-placeholder"></div>
            <% end %>

            <!-- Like/Dislike buttons (right side) -->
            <% if user_signed_in? %>
              <div class="quote-engagement" data-quote-id="<%= @quote.id %>">
                <button class="engagement-btn like-btn <%= 'like-active' if @user_like_status == 'like' %>"
                        data-type="like" data-quote-id="<%= @quote.id %>"
                        aria-label="Like this quote"
                        aria-pressed="<%= (@user_like_status == 'like') ? 'true' : 'false' %>">
                  <span class="thumb-icon">
                    <svg viewBox="0 0 24 24">
                      <path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path>
                    </svg>
                  </span>
                  <span class="count"><%= @likes_count %></span>
                </button>
                
                <button class="engagement-btn dislike-btn <%= 'dislike-active' if @user_like_status == 'dislike' %>"
                        data-type="dislike" data-quote-id="<%= @quote.id %>"
                        aria-label="Dislike this quote"
                        aria-pressed="<%= (@user_like_status == 'dislike') ? 'true' : 'false' %>">
                  <span class="thumb-icon">
                    <svg viewBox="0 0 24 24">
                      <path d="M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"></path>
                    </svg>
                  </span>
                  <span class="count"><%= @dislikes_count %></span>
                </button>
              </div>
            <% else %>
              <div class="quote-engagement-wrapper">
                <p class="empty-message" style="text-align: center; margin-bottom: 0.5rem; font-size: 0.9rem;">
                  <a href="/users/sign_in" style="color: #8b7355; text-decoration: underline;">Sign in</a> 
                  to like/dislike
                </p>
                <div class="quote-engagement">
                  <div class="engagement-btn">
                    <span class="thumb-icon">
                      <svg viewBox="0 0 24 24">
                        <path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path>
                      </svg>
                    </span>
                    <span class="count"><%= @likes_count %></span>
                  </div>
                  <div class="engagement-btn">
                    <span class="thumb-icon">
                      <svg viewBox="0 0 24 24">
                        <path d="M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"></path>
                      </svg>
                    </span>
                    <span class="count"><%= @dislikes_count %></span>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <!-- Comments Section -->
    <div class="interaction-section">
      <div class="interaction-card">
        <div class="comments-section">
          <h2 class="section-title">
            Comments (<%= @comments_count %>)
          </h2>

          <!-- Comment Form -->
          <% if user_signed_in? %>
            <p>Comment form temporarily disabled</p>
          <% else %>
            <div class="comment-form">
              <p class="empty-message" style="text-align: center;">
                <a href="/users/sign_in" style="color: #8b7355; text-decoration: underline;">Sign in</a>
                to join the conversation
              </p>
            </div>
          <% end %>

          <!-- Comments List -->
          <div class="comments-list" id="comments-list">
            <% if @comments.any? %>
              <p>Comments disabled for testing: <%= @comments.count %> comments exist</p>
            <% else %>
              <div class="empty-message" style="text-align: center; padding: 2rem;">
                No comments yet. Be the first to share your thoughts!
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  <% else %>
    <div class="no-quote">
      <h2>No quote for this date</h2>
      <p>There was no quote displayed on <%= @discover_date.strftime('%B %d, %Y') %>.</p>
      <div style="margin-top: 1.5rem;">
        <%= link_to "Back to Discovered Quotes", discover_index_path, class: "back-to-discover" %>
        <%= link_to "Browse Discover", discover_index_path, class: "back-to-discover", style: "margin-left: 1rem;" %>
      </div>
    </div>
  <% end %>
</div>